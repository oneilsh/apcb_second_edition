<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Patterns (Regular Expressions) | A Primer for Computational Biology (2nd Edition)</title>
  <meta name="description" content="Chapter 12 Patterns (Regular Expressions) | A Primer for Computational Biology (2nd Edition)" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Patterns (Regular Expressions) | A Primer for Computational Biology (2nd Edition)" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Patterns (Regular Expressions) | A Primer for Computational Biology (2nd Edition)" />
  
  
  

<meta name="author" content="Shawn T. O’Neil, Matthew Peterson, Leslie Coonrod" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rows-and-columns.html"/>
<link rel="next" href="miscellanea.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="packages/prism/prism.js"></script>

<script>
  Prism.plugins.NormalizeWhitespace.setDefaults({
	'remove-trailing': false,
	'remove-indent': false,
	'left-trim': true,
	'right-trim': true,
	'remove-initial-line-feed': true,
	/*'break-lines': 80*/

	/*'break-lines': 80,
	'indent': 2,
	'remove-initial-line-feed': false,
	'tabs-to-spaces': 4,
	'spaces-to-tabs': 4*/
});
</script>

<link rel="stylesheet" href="packages/prism/prism.css">

<style>
.book .book-body .page-wrapper .page-inner section.normal pre {
  background: #fafafa;
}

.book .book-body .page-wrapper .page-inner section.normal pre>code {
  display: block;
}

.book .book-body .page-wrapper .page-inner section.normal pre[class*="language-"].line-numbers {
    position: relative;
    padding-left: 3em;
    counter-reset: linenumber;
}

.line-highlight {
  margin-top: 0.7em;
}

.temporary {
  background: none; /*linear-gradient(to right, rgba(100, 150, 180, .5) 70%, rgba(100, 150, 180, 0)); */
}

.book .book-body .page-wrapper .page-inner section.normal h6 {
  margin-top: 0;
  margin-bottom: 0;
}

.command-line-prompt {
  margin-right: 0.2em;
  border-right: none;
}

.callout-box,.exercises {
  box-shadow: rgba(60, 64, 67, 0.3) 0px 1px 2px 0px, rgba(60, 64, 67, 0.15) 0px 1px 3px 1px;
  border-radius: 4px;
  margin: 25px 10px 10px 10px;
  padding: 10px;
}

.book .book-body .page-wrapper .page-inner section.normal .callout-box h4 {
  margin-top: 0;
}

.book .book-body .page-wrapper .page-inner section.normal .exercises h4 {
  margin-top: 0;
  color: #960018;
}


.fig.center {
  margin: 0 auto;
  display: block;
}

.fig.left {
  display: inline-block;
  float: left;
}

.fig.right {
  display: inline-block;
  float: right;
}

.fig>p.caption {
  color: #AAAAAA;
  text-align: left;
}

</style>





<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><b>A Primer for Computational Biology <br />(2nd Edition)</b></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-few-goals"><i class="fa fa-check"></i>A Few Goals</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i>Organization</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#availability"><i class="fa fa-check"></i>Availability</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="dedication.html"><a href="dedication.html"><i class="fa fa-check"></i>Dedication</a></li>
<li class="part"><span><b>Part 1: The UNIX/Linux Command-Line</b></span></li>
<li class="chapter" data-level="1" data-path="context.html"><a href="context.html"><i class="fa fa-check"></i><b>1</b> Context</a>
<ul>
<li class="chapter" data-level="" data-path="context.html"><a href="context.html#command-lines-and-operating-systems"><i class="fa fa-check"></i>Command Lines and Operating Systems</a></li>
<li class="chapter" data-level="" data-path="context.html"><a href="context.html#a-brief-history"><i class="fa fa-check"></i>A Brief History</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="logging-in.html"><a href="logging-in.html"><i class="fa fa-check"></i><b>2</b> Logging In</a>
<ul>
<li class="chapter" data-level="" data-path="logging-in.html"><a href="logging-in.html#ssh-secure-shell"><i class="fa fa-check"></i>SSH: Secure Shell</a></li>
<li class="chapter" data-level="" data-path="logging-in.html"><a href="logging-in.html#command-line-access-with-cyverse-atmosphere"><i class="fa fa-check"></i>Command-Line Access with CyVerse Atmosphere</a></li>
<li class="chapter" data-level="" data-path="logging-in.html"><a href="logging-in.html#logging-out"><i class="fa fa-check"></i>Logging Out</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-command-line-and-filesystem.html"><a href="the-command-line-and-filesystem.html"><i class="fa fa-check"></i><b>3</b> The Command Line and Filesystem</a>
<ul>
<li class="chapter" data-level="" data-path="the-command-line-and-filesystem.html"><a href="the-command-line-and-filesystem.html#setting-environment-variables-dealing-with-spaces"><i class="fa fa-check"></i>Setting Environment Variables, Dealing with Spaces</a></li>
<li class="chapter" data-level="" data-path="the-command-line-and-filesystem.html"><a href="the-command-line-and-filesystem.html#alternative-shells"><i class="fa fa-check"></i>Alternative Shells</a></li>
<li class="chapter" data-level="" data-path="the-command-line-and-filesystem.html"><a href="the-command-line-and-filesystem.html#files-directories-and-paths"><i class="fa fa-check"></i>Files, Directories, and Paths</a></li>
<li class="chapter" data-level="" data-path="the-command-line-and-filesystem.html"><a href="the-command-line-and-filesystem.html#getting-around-the-filesystem"><i class="fa fa-check"></i>Getting around the Filesystem</a></li>
<li class="chapter" data-level="" data-path="the-command-line-and-filesystem.html"><a href="the-command-line-and-filesystem.html#relative-paths-hidden-files-and-directories"><i class="fa fa-check"></i>Relative Paths, Hidden Files, and Directories</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html"><i class="fa fa-check"></i><b>4</b> Working with Files and Directories</a>
<ul>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#viewing-the-contents-of-a-text-file"><i class="fa fa-check"></i>Viewing the Contents of a (Text) File</a></li>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#creating-new-directories"><i class="fa fa-check"></i>Creating New Directories</a></li>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#move-or-rename-a-file-or-directory"><i class="fa fa-check"></i>Move or Rename a File or Directory</a></li>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#copy-a-file-or-directory"><i class="fa fa-check"></i>Copy a File or Directory</a></li>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#remove-delete-a-file-or-directory"><i class="fa fa-check"></i>Remove (Delete) a File or Directory</a></li>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#checking-the-size-of-a-file-or-directory"><i class="fa fa-check"></i>Checking the Size of a File or Directory</a></li>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#editing-a-text-file"><i class="fa fa-check"></i>Editing a (Text) File</a></li>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#command-line-efficiency"><i class="fa fa-check"></i>Command-Line Efficiency</a></li>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#getting-help-on-a-command-or-program"><i class="fa fa-check"></i>Getting Help on a Command or Program</a></li>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#viewing-the-top-running-programs"><i class="fa fa-check"></i>Viewing the Top Running Programs</a></li>
<li class="chapter" data-level="" data-path="working-with-files-and-directories.html"><a href="working-with-files-and-directories.html#killing-rogue-programs"><i class="fa fa-check"></i>Killing Rogue Programs</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="permissions-and-executables.html"><a href="permissions-and-executables.html"><i class="fa fa-check"></i><b>5</b> Permissions and Executables</a>
<ul>
<li class="chapter" data-level="" data-path="permissions-and-executables.html"><a href="permissions-and-executables.html#executables-and-path"><i class="fa fa-check"></i>Executables and $PATH</a></li>
<li class="chapter" data-level="" data-path="permissions-and-executables.html"><a href="permissions-and-executables.html#making-files-executable"><i class="fa fa-check"></i>Making Files Executable</a></li>
<li class="chapter" data-level="" data-path="permissions-and-executables.html"><a href="permissions-and-executables.html#installing-a-program"><i class="fa fa-check"></i>Installing a Program</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="installing-bioinformatics-software.html"><a href="installing-bioinformatics-software.html"><i class="fa fa-check"></i><b>6</b> Installing (Bioinformatics) Software</a>
<ul>
<li class="chapter" data-level="" data-path="installing-bioinformatics-software.html"><a href="installing-bioinformatics-software.html#using-a-package-manager"><i class="fa fa-check"></i>Using a Package Manager</a></li>
<li class="chapter" data-level="" data-path="installing-bioinformatics-software.html"><a href="installing-bioinformatics-software.html#installing-software-without-a-package-manager"><i class="fa fa-check"></i>Installing Software without a Package Manager</a></li>
<li class="chapter" data-level="" data-path="installing-bioinformatics-software.html"><a href="installing-bioinformatics-software.html#source-or-binary"><i class="fa fa-check"></i>Source or Binary?</a></li>
<li class="chapter" data-level="" data-path="installing-bioinformatics-software.html"><a href="installing-bioinformatics-software.html#downloading-and-unpacking"><i class="fa fa-check"></i>Downloading and Unpacking</a></li>
<li class="chapter" data-level="" data-path="installing-bioinformatics-software.html"><a href="installing-bioinformatics-software.html#other-download-and-compression-methods"><i class="fa fa-check"></i>Other Download and Compression Methods</a></li>
<li class="chapter" data-level="" data-path="installing-bioinformatics-software.html"><a href="installing-bioinformatics-software.html#compiling-the-source"><i class="fa fa-check"></i>Compiling the Source</a></li>
<li class="chapter" data-level="" data-path="installing-bioinformatics-software.html"><a href="installing-bioinformatics-software.html#installation-from-binaries"><i class="fa fa-check"></i>Installation from Binaries</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="using-bioinformatics-software.html"><a href="using-bioinformatics-software.html"><i class="fa fa-check"></i><b>7</b> Using (Bioinformatics) Software</a>
<ul>
<li class="chapter" data-level="" data-path="using-bioinformatics-software.html"><a href="using-bioinformatics-software.html#getting-data"><i class="fa fa-check"></i>Getting Data</a></li>
<li class="chapter" data-level="" data-path="using-bioinformatics-software.html"><a href="using-bioinformatics-software.html#putting-it-all-together"><i class="fa fa-check"></i>Putting It All Together</a></li>
<li class="chapter" data-level="" data-path="using-bioinformatics-software.html"><a href="using-bioinformatics-software.html#reproducibility-with-scripts"><i class="fa fa-check"></i>Reproducibility with Scripts</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="command-line-blast.html"><a href="command-line-blast.html"><i class="fa fa-check"></i><b>8</b> Command Line BLAST</a>
<ul>
<li class="chapter" data-level="" data-path="command-line-blast.html"><a href="command-line-blast.html#blast-types"><i class="fa fa-check"></i>BLAST Types</a></li>
<li class="chapter" data-level="" data-path="command-line-blast.html"><a href="command-line-blast.html#blast-databases"><i class="fa fa-check"></i>BLAST Databases</a></li>
<li class="chapter" data-level="" data-path="command-line-blast.html"><a href="command-line-blast.html#running-a-self-blast"><i class="fa fa-check"></i>Running a Self-BLAST</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="the-standard-streams.html"><a href="the-standard-streams.html"><i class="fa fa-check"></i><b>9</b> The Standard Streams</a>
<ul>
<li class="chapter" data-level="" data-path="the-standard-streams.html"><a href="the-standard-streams.html#filtering-lines-standard-input"><i class="fa fa-check"></i>Filtering Lines, Standard Input</a></li>
<li class="chapter" data-level="" data-path="the-standard-streams.html"><a href="the-standard-streams.html#counting-simple-at-repeats"><i class="fa fa-check"></i>Counting Simple AT Repeats</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sorting-first-and-last-lines.html"><a href="sorting-first-and-last-lines.html"><i class="fa fa-check"></i><b>10</b> Sorting, First and Last Lines</a>
<ul>
<li class="chapter" data-level="" data-path="sorting-first-and-last-lines.html"><a href="sorting-first-and-last-lines.html#first-and-last-lines"><i class="fa fa-check"></i>First and Last Lines</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="rows-and-columns.html"><a href="rows-and-columns.html"><i class="fa fa-check"></i><b>11</b> Rows and columns</a>
<ul>
<li class="chapter" data-level="" data-path="rows-and-columns.html"><a href="rows-and-columns.html#basic-syntax-for-awk"><i class="fa fa-check"></i>Basic Syntax for awk</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="patterns-regular-expressions.html"><a href="patterns-regular-expressions.html"><i class="fa fa-check"></i><b>12</b> Patterns (Regular Expressions)</a>
<ul>
<li class="chapter" data-level="" data-path="patterns-regular-expressions.html"><a href="patterns-regular-expressions.html#regular-expressions"><i class="fa fa-check"></i>Regular Expressions</a></li>
<li class="chapter" data-level="" data-path="patterns-regular-expressions.html"><a href="patterns-regular-expressions.html#character-classes-and-regular-expressions-in-other-tools"><i class="fa fa-check"></i>Character Classes and Regular Expressions in Other Tools</a></li>
<li class="chapter" data-level="" data-path="patterns-regular-expressions.html"><a href="patterns-regular-expressions.html#back-referencing"><i class="fa fa-check"></i>Back-Referencing</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="miscellanea.html"><a href="miscellanea.html"><i class="fa fa-check"></i><b>13</b> Miscellanea</a>
<ul>
<li class="chapter" data-level="" data-path="miscellanea.html"><a href="miscellanea.html#manipulating-line-breaks"><i class="fa fa-check"></i>Manipulating Line Breaks</a></li>
<li class="chapter" data-level="" data-path="miscellanea.html"><a href="miscellanea.html#joining-files-on-a-common-column-and-related-rowcolumn-tasks"><i class="fa fa-check"></i>Joining Files on a Common Column (and Related Row/Column Tasks)</a></li>
<li class="chapter" data-level="" data-path="miscellanea.html"><a href="miscellanea.html#counting-duplicate-lines"><i class="fa fa-check"></i>Counting Duplicate Lines</a></li>
<li class="chapter" data-level="" data-path="miscellanea.html"><a href="miscellanea.html#for-loops-in-bash"><i class="fa fa-check"></i>For-Loops in bash</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="version-control-with-git.html"><a href="version-control-with-git.html"><i class="fa fa-check"></i><b>14</b> Version Control with git</a>
<ul>
<li class="chapter" data-level="" data-path="version-control-with-git.html"><a href="version-control-with-git.html#configuring-git"><i class="fa fa-check"></i>Configuring <code>git</code></a></li>
<li class="chapter" data-level="" data-path="version-control-with-git.html"><a href="version-control-with-git.html#initializing-a-repo"><i class="fa fa-check"></i>Initializing a Repo</a></li>
<li class="chapter" data-level="" data-path="version-control-with-git.html"><a href="version-control-with-git.html#viewing-changes-bewteen-commits"><i class="fa fa-check"></i>Viewing changes bewteen commits</a></li>
<li class="chapter" data-level="" data-path="version-control-with-git.html"><a href="version-control-with-git.html#keep-files-untracked-with-.gitignore"><i class="fa fa-check"></i>Keep files untracked with <code>.gitignore</code></a></li>
<li class="chapter" data-level="" data-path="version-control-with-git.html"><a href="version-control-with-git.html#branching"><i class="fa fa-check"></i>Branching</a></li>
<li class="chapter" data-level="" data-path="version-control-with-git.html"><a href="version-control-with-git.html#remote-repos"><i class="fa fa-check"></i>Remote Repos</a></li>
</ul></li>
<li class="part"><span><b>Part 2: Programming in Python</b></span></li>
<li class="chapter" data-level="15" data-path="hello-world.html"><a href="hello-world.html"><i class="fa fa-check"></i><b>15</b> Hello, World</a>
<ul>
<li class="chapter" data-level="" data-path="hello-world.html"><a href="hello-world.html#hello-world-1"><i class="fa fa-check"></i>Hello, World</a></li>
<li class="chapter" data-level="" data-path="hello-world.html"><a href="hello-world.html#making-the-file-executable"><i class="fa fa-check"></i>Making the File Executable</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="elementary-data-types.html"><a href="elementary-data-types.html"><i class="fa fa-check"></i><b>16</b> Elementary Data Types</a>
<ul>
<li class="chapter" data-level="" data-path="elementary-data-types.html"><a href="elementary-data-types.html#integers-and-floats"><i class="fa fa-check"></i>Integers and Floats</a></li>
<li class="chapter" data-level="" data-path="elementary-data-types.html"><a href="elementary-data-types.html#booleans"><i class="fa fa-check"></i>Booleans</a></li>
<li class="chapter" data-level="" data-path="elementary-data-types.html"><a href="elementary-data-types.html#strings"><i class="fa fa-check"></i>Strings</a></li>
<li class="chapter" data-level="" data-path="elementary-data-types.html"><a href="elementary-data-types.html#immutability"><i class="fa fa-check"></i>Immutability</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="collections-and-looping-lists-and-for.html"><a href="collections-and-looping-lists-and-for.html"><i class="fa fa-check"></i><b>17</b> Collections and Looping: Lists and for</a>
<ul>
<li class="chapter" data-level="" data-path="collections-and-looping-lists-and-for.html"><a href="collections-and-looping-lists-and-for.html#tuples-immutable-lists"><i class="fa fa-check"></i>Tuples (Immutable Lists)</a></li>
<li class="chapter" data-level="" data-path="collections-and-looping-lists-and-for.html"><a href="collections-and-looping-lists-and-for.html#looping-with-for"><i class="fa fa-check"></i>Looping with for</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="file-input-and-output.html"><a href="file-input-and-output.html"><i class="fa fa-check"></i><b>18</b> File Input and Output</a>
<ul>
<li class="chapter" data-level="" data-path="file-input-and-output.html"><a href="file-input-and-output.html#writing-data"><i class="fa fa-check"></i>Writing Data</a></li>
<li class="chapter" data-level="" data-path="file-input-and-output.html"><a href="file-input-and-output.html#computing-a-mean"><i class="fa fa-check"></i>Computing a Mean</a></li>
<li class="chapter" data-level="" data-path="file-input-and-output.html"><a href="file-input-and-output.html#the-process-of-programming"><i class="fa fa-check"></i>The Process of Programming</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="conditional-control-flow.html"><a href="conditional-control-flow.html"><i class="fa fa-check"></i><b>19</b> Conditional Control Flow</a>
<ul>
<li class="chapter" data-level="" data-path="conditional-control-flow.html"><a href="conditional-control-flow.html#using-if-statements"><i class="fa fa-check"></i>Using If-Statements</a></li>
<li class="chapter" data-level="" data-path="conditional-control-flow.html"><a href="conditional-control-flow.html#using-while-loops"><i class="fa fa-check"></i>Using While-Loops</a></li>
<li class="chapter" data-level="" data-path="conditional-control-flow.html"><a href="conditional-control-flow.html#boolean-operators-and-connectives"><i class="fa fa-check"></i>Boolean Operators and Connectives</a></li>
<li class="chapter" data-level="" data-path="conditional-control-flow.html"><a href="conditional-control-flow.html#logical-dangers"><i class="fa fa-check"></i>Logical Dangers</a></li>
<li class="chapter" data-level="" data-path="conditional-control-flow.html"><a href="conditional-control-flow.html#counting-stop-codons"><i class="fa fa-check"></i>Counting Stop Codons</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="python-functions.html"><a href="python-functions.html"><i class="fa fa-check"></i><b>20</b> Python Functions</a>
<ul>
<li class="chapter" data-level="" data-path="python-functions.html"><a href="python-functions.html#important-notes-about-functions"><i class="fa fa-check"></i>Important Notes about Functions</a></li>
<li class="chapter" data-level="" data-path="python-functions.html"><a href="python-functions.html#gc-content-over-sequences-in-a-file"><i class="fa fa-check"></i>GC Content over Sequences in a File</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="command-line-interfacing.html"><a href="command-line-interfacing.html"><i class="fa fa-check"></i><b>21</b> Command Line Interfacing</a>
<ul>
<li class="chapter" data-level="" data-path="command-line-interfacing.html"><a href="command-line-interfacing.html#standard-input-is-a-file-handle"><i class="fa fa-check"></i>Standard Input is a File Handle</a></li>
<li class="chapter" data-level="" data-path="command-line-interfacing.html"><a href="command-line-interfacing.html#standard-output-as-a-file-handle"><i class="fa fa-check"></i>Standard Output as a File Handle</a></li>
<li class="chapter" data-level="" data-path="command-line-interfacing.html"><a href="command-line-interfacing.html#command-line-parameters"><i class="fa fa-check"></i>Command Line Parameters</a></li>
<li class="chapter" data-level="" data-path="command-line-interfacing.html"><a href="command-line-interfacing.html#executing-shell-commands-within-python"><i class="fa fa-check"></i>Executing Shell Commands within Python</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="dictionaries.html"><a href="dictionaries.html"><i class="fa fa-check"></i><b>22</b> Dictionaries</a>
<ul>
<li class="chapter" data-level="" data-path="dictionaries.html"><a href="dictionaries.html#counting-gene-ontology-terms"><i class="fa fa-check"></i>Counting Gene Ontology Terms</a></li>
<li class="chapter" data-level="" data-path="dictionaries.html"><a href="dictionaries.html#extracting-all-lines-matching-a-set-of-ids"><i class="fa fa-check"></i>Extracting All Lines Matching a Set of IDs</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html"><i class="fa fa-check"></i><b>23</b> String Tips and Regular Expressions</a>
<ul>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#converting-a-string-into-a-list-of-single-character-strings"><i class="fa fa-check"></i>Converting a String into a List of Single-Character Strings</a></li>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#converting-a-list-of-strings-into-a-string"><i class="fa fa-check"></i>Converting a List of Strings into a String</a></li>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#reverse-a-list"><i class="fa fa-check"></i>Reverse a List</a></li>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#reverse-a-string"><i class="fa fa-check"></i>Reverse a String</a></li>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#simple-find-and-replace-in-a-string"><i class="fa fa-check"></i>Simple Find and Replace in a String</a></li>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#commands-versus-queries"><i class="fa fa-check"></i>Commands versus Queries</a></li>
<li class="chapter" data-level="23.0.1" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#regular-expressions-1"><i class="fa fa-check"></i><b>23.0.1</b> Regular Expressions</a></li>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#searching-for-a-pattern-in-a-string"><i class="fa fa-check"></i>Searching for a Pattern in a String</a></li>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#replace-a-pattern-in-a-string"><i class="fa fa-check"></i>Replace a Pattern in a String</a></li>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#split-a-string-into-a-list-of-strings-based-on-a-pattern"><i class="fa fa-check"></i>Split a String into a List of Strings Based on a Pattern</a></li>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#the-language-of-regular-expressions-in-python"><i class="fa fa-check"></i>The Language of Regular Expressions, in Python</a></li>
<li class="chapter" data-level="" data-path="string-tips-and-regular-expressions.html"><a href="string-tips-and-regular-expressions.html#counting-promoter-elements"><i class="fa fa-check"></i>Counting Promoter Elements</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="variables-and-scope.html"><a href="variables-and-scope.html"><i class="fa fa-check"></i><b>24</b> Variables and Scope</a></li>
<li class="chapter" data-level="25" data-path="variables-and-classes.html"><a href="variables-and-classes.html"><i class="fa fa-check"></i><b>25</b> Variables and Classes</a>
<ul>
<li class="chapter" data-level="" data-path="variables-and-classes.html"><a href="variables-and-classes.html#creating-new-classes"><i class="fa fa-check"></i>Creating New Classes</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="use-case-counting-snps.html"><a href="use-case-counting-snps.html"><i class="fa fa-check"></i><b>26</b> Use Case: Counting SNPs</a>
<ul>
<li class="chapter" data-level="" data-path="use-case-counting-snps.html"><a href="use-case-counting-snps.html#snp-class"><i class="fa fa-check"></i>SNP Class</a></li>
<li class="chapter" data-level="" data-path="use-case-counting-snps.html"><a href="use-case-counting-snps.html#chromosome-class"><i class="fa fa-check"></i>Chromosome Class</a></li>
<li class="chapter" data-level="" data-path="use-case-counting-snps.html"><a href="use-case-counting-snps.html#an-extension-searching-for-snp-dense-regions"><i class="fa fa-check"></i>An Extension: Searching for SNP-Dense Regions</a></li>
<li class="chapter" data-level="" data-path="use-case-counting-snps.html"><a href="use-case-counting-snps.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="application-programming-interfaces-modules-packages-syntactic-sugar.html"><a href="application-programming-interfaces-modules-packages-syntactic-sugar.html"><i class="fa fa-check"></i><b>27</b> Application Programming Interfaces, Modules, Packages, Syntactic Sugar</a>
<ul>
<li class="chapter" data-level="" data-path="application-programming-interfaces-modules-packages-syntactic-sugar.html"><a href="application-programming-interfaces-modules-packages-syntactic-sugar.html#modules"><i class="fa fa-check"></i>Modules</a></li>
<li class="chapter" data-level="" data-path="application-programming-interfaces-modules-packages-syntactic-sugar.html"><a href="application-programming-interfaces-modules-packages-syntactic-sugar.html#creating-a-module"><i class="fa fa-check"></i>Creating a Module</a></li>
<li class="chapter" data-level="" data-path="application-programming-interfaces-modules-packages-syntactic-sugar.html"><a href="application-programming-interfaces-modules-packages-syntactic-sugar.html#packages"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="application-programming-interfaces-modules-packages-syntactic-sugar.html"><a href="application-programming-interfaces-modules-packages-syntactic-sugar.html#parsing-a-fasta-file"><i class="fa fa-check"></i>Parsing a FASTA File</a></li>
<li class="chapter" data-level="" data-path="application-programming-interfaces-modules-packages-syntactic-sugar.html"><a href="application-programming-interfaces-modules-packages-syntactic-sugar.html#syntactic-sugar"><i class="fa fa-check"></i>Syntactic Sugar</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="algorithms-and-data-structures.html"><a href="algorithms-and-data-structures.html"><i class="fa fa-check"></i><b>28</b> Algorithms and Data Structures</a>
<ul>
<li class="chapter" data-level="" data-path="algorithms-and-data-structures.html"><a href="algorithms-and-data-structures.html#order-notation"><i class="fa fa-check"></i>Order Notation</a></li>
<li class="chapter" data-level="" data-path="algorithms-and-data-structures.html"><a href="algorithms-and-data-structures.html#data-structures"><i class="fa fa-check"></i>Data Structures</a></li>
<li class="chapter" data-level="" data-path="algorithms-and-data-structures.html"><a href="algorithms-and-data-structures.html#sorted-linked-lists"><i class="fa fa-check"></i>Sorted Linked Lists</a></li>
<li class="chapter" data-level="" data-path="algorithms-and-data-structures.html"><a href="algorithms-and-data-structures.html#linked-list-methods"><i class="fa fa-check"></i>Linked List Methods</a></li>
<li class="chapter" data-level="" data-path="algorithms-and-data-structures.html"><a href="algorithms-and-data-structures.html#divide-and-conquer"><i class="fa fa-check"></i>Divide and Conquer</a></li>
<li class="chapter" data-level="" data-path="algorithms-and-data-structures.html"><a href="algorithms-and-data-structures.html#back-to-sorting"><i class="fa fa-check"></i>Back to Sorting</a></li>
</ul></li>
<li class="part"><span><b>Part 3: Programming in R</b></span></li>
<li class="chapter" data-level="29" data-path="an-introduction.html"><a href="an-introduction.html"><i class="fa fa-check"></i><b>29</b> An Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="an-introduction.html"><a href="an-introduction.html#hello-world-2"><i class="fa fa-check"></i>Hello, World</a></li>
<li class="chapter" data-level="" data-path="an-introduction.html"><a href="an-introduction.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
<li class="chapter" data-level="" data-path="an-introduction.html"><a href="an-introduction.html#librariespackages"><i class="fa fa-check"></i>Libraries/Packages</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="variables-and-data.html"><a href="variables-and-data.html"><i class="fa fa-check"></i><b>30</b> Variables and Data</a>
<ul>
<li class="chapter" data-level="" data-path="variables-and-data.html"><a href="variables-and-data.html#numerics-integers-characters-and-logicals"><i class="fa fa-check"></i>Numerics, Integers, Characters, and Logicals</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>31</b> Vectors</a>
<ul>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#no-naked-data-vectors-have-a-class"><i class="fa fa-check"></i>No “Naked Data”: Vectors Have (a) Class</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#subsetting-vectors-selective-replacement"><i class="fa fa-check"></i>Subsetting Vectors, Selective Replacement</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#vectorized-operations-na-values"><i class="fa fa-check"></i>Vectorized Operations, <code>NA</code> Values</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#vector-recycling"><i class="fa fa-check"></i>Vector Recycling</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#common-vector-functions"><i class="fa fa-check"></i>Common Vector Functions</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#generating-random-data"><i class="fa fa-check"></i>Generating Random Data</a></li>
<li class="chapter" data-level="" data-path="vectors.html"><a href="vectors.html#reading-and-writing-tabular-data-wrapping-long-lines"><i class="fa fa-check"></i>Reading and Writing Tabular Data, Wrapping Long Lines</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="r-functions.html"><a href="r-functions.html"><i class="fa fa-check"></i><b>32</b> R Functions</a>
<ul>
<li class="chapter" data-level="" data-path="r-functions.html"><a href="r-functions.html#variables-and-scope-1"><i class="fa fa-check"></i>Variables and Scope</a></li>
<li class="chapter" data-level="" data-path="r-functions.html"><a href="r-functions.html#getting-help"><i class="fa fa-check"></i>Getting Help</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="lists-and-attributes.html"><a href="lists-and-attributes.html"><i class="fa fa-check"></i><b>33</b> Lists and Attributes</a>
<ul>
<li class="chapter" data-level="" data-path="lists-and-attributes.html"><a href="lists-and-attributes.html#named-lists-lists-within-lists"><i class="fa fa-check"></i>Named Lists, Lists within Lists</a></li>
<li class="chapter" data-level="33.0.1" data-path="lists-and-attributes.html"><a href="lists-and-attributes.html#attributes-removing-elements-list-structure"><i class="fa fa-check"></i><b>33.0.1</b> Attributes, Removing Elements, List Structure</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>34</b> Data Frames</a>
<ul>
<li class="chapter" data-level="" data-path="data-frames.html"><a href="data-frames.html#data-frame-operations"><i class="fa fa-check"></i>Data Frame Operations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Primer for Computational Biology (2nd Edition)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="patterns-regular-expressions" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Patterns (Regular Expressions)<a href="patterns-regular-expressions.html#patterns-regular-expressions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In previous chapters, we used a simple <a href="data/fasta_stats.py"><code>fasta_stats</code></a> program to perform basic analyses on a FASTA file called <a href="data/pz_cDNAs.fasta"><code>pz_cDNAs.fasta</code></a>, mostly as an excuse to learn about the standard streams and tools like <code>grep</code> and <code>sort</code>. It turns out that the information in the <a href="data/pz_cDNAs.fasta"><code>pz_cDNAs.fasta</code></a> file provides us with many potential questions to ponder.</p>
<p>The sequences in this file are actually a subset of putative transcripts, produced from a de novo transcriptome assembly for the butterfly <em>Papilio zelicaon</em>. Each sequence header line encodes a variety of information: the second and third columns of the header lines reveal the number of reads contributing to each assembled sequence and the average coverage of the sequence (defined as the total number of bases contributed by reads, divided by the assembled sequence length). Even the sequence IDs encode some information: they all start with a pseudorandom identifier, but some have a suffix like <code>_TY</code>.</p>
<div class="fig center" style="width: 100%">
<p><img src="images/part1-12-patterns.Rmd.images/I.12_1_unix_133_pz_cdnas_less.png" /></p>
</div>
<p>Groups of sequences that share the same <code>_</code> suffix were previously identified as having shared matches using a self-BLAST. Sequence IDs without such a suffix had no matches. We might ask: how many sequences are in such a group? This could be easily answered by first using <code>grep</code> to extract lines that match <code>&gt;</code> (the header lines), and then using another <code>grep</code> to extract those with the pattern <code>_</code> (those in a group) before sending the result to <code>wc</code>.</p>
<p>A more complex question would be to ask how many different groups are represented in the file. If the group information was stored in a separate column (say, the second column), this question could be answered with the same process as above, followed by a <code>sort -k2,2d -u</code> to remove duplicate group identifiers. But how can we coerce the group information into its own column? We could do this by <em>substituting</em> instances of <code>_</code> with spaces. The <code>sed</code> (Stream EDitor) tool can help us. Here’s the overall pipeline we’ll use:</p>
<pre id=part1-12-sed
     class="language-txt 
            line-numbers 
            linkable-line-numbers">
<code>
[oneils@mbp ~/apcb/intro/fasta_stats]$ <b>cat pz_cDNAs.fasta | \
> grep '>' | \
> grep '_' | \
<span style="background-color:LemonChiffon">> sed -r 's/_/ /' | \</span>
> sort -k2,2d -u | \
> less -S
</b></code></pre>
<p>And here is some of the output, where only sequences in groups are represented and each group is represented only once (replacing the <code>less -S</code> with <code>wc</code> would thus count the number of groups):</p>
<pre id=part1-12-output
     class="language-txt 
            line-numbers 
            linkable-line-numbers">
<code>
<b>...
>PZ7180000000067 AF nReads=16 cov=12.0608
>PZ7180000028269 AFW nReads=3 cov=2.97992
>PZ7180000036480 AIJ nReads=11 cov=4.61416
>PZ783221 AOC nReads=1 cov=1
...
</b></code></pre>
<p>The <code>sed</code> tool is a sophisticated program for modifying input (either from a file or standard input) and printing the results to standard output: <code>sed '&lt;program&gt;' &lt;file&gt;</code> or<code>... | sed '&lt;program&gt;'</code>.</p>
<p>Like <code>awk</code>, <code>sed</code> hails from the 1970s and provides a huge variety of powerful features and syntax, only a tiny fraction of which we’ll cover here. In particular, we’ll focus on the <code>s</code>, or substitution, operation.</p>
<div class="fig center" style="width: 100%">
<p><img src="images/part1-12-patterns.Rmd.images/I.12_4_sed_syntax.png" /></p>
</div>
<p>The <code>-r</code> option that we’ve used lets <code>sed</code> know that we want our pattern to be specified by “POSIX extended regular expression” syntax.<a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a> The general pattern of the program for substitution is <code>s/&lt;pattern&gt;/&lt;replacement&gt;/g</code>, where the <code>g</code> specifies that, for each line, each instance of the pattern should be replaced. We can alternatively use <code>1</code> in this spot to indicate that only the first instance should be replaced, <code>2</code> to indicate only the second, and so on. Often, <code>s/&lt;pattern&gt;/&lt;replacement&gt;/</code> is used, as it has the same meaning as <code>s/&lt;pattern&gt;/&lt;replacement&gt;/1</code>.<a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a></p>
<div id="regular-expressions" class="section level3 unnumbered hasAnchor">
<h3>Regular Expressions<a href="patterns-regular-expressions.html#regular-expressions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The true power of <code>sed</code> comes not from its ability to replace text, but from its utility in replacing text based on “patterns” or, more formally, <em>regular expressions</em>. A regular expression is a syntax for describing pattern matching in strings. Regular expressions are described by the individual characters that make up the pattern to search for, and “meta-operators” that modify parts of the pattern for flexibility. In <code>[ch]at</code>, for example, the brackets function as a meta-operator meaning “one of these characters,” and this pattern matches both <code>cat</code> and <code>hat</code>, but not <code>chat</code>. Regular expressions are often built by chaining smaller expressions, as in <code>[ch]at on the [mh]at</code>, matching <code>cat on the hat</code>, <code>cat on the mat</code>, <code>hat on the hat</code>, and <code>hat on the mat</code>.</p>
<p>In the example above, the entire pattern was specified by <code>_</code>, which is not a meta-operator of any kind, and so each instance of <code>_</code> was replaced by the replacement (a space character). The meta-operators that are supported by regular expressions are many and varied, but here’s a basic list along with some biologically inspired examples:</p>
<ul style="list-style-type:none;">
<li>
non-meta-operator characters or strings
</li>
<ul style="list-style-type:none;">
<li>
Most characters that don’t operate in a meta-fashion are simply matched. For example, <code>_</code> matches <code>_</code>, <code>A</code> matches <code>A</code>, and <code>ATG</code> matches a start codon. (In fact, <code>ATG</code> is three individual patterns specified in a row.) When in doubt, it is usually safe to escape a character (by prefixing it with a backslash) to ensure it is interpreted literally. For example, <code>\[_\]</code> matches the literal string <code>[_]</code>, rather than making use of the brackets as meta-operators.
</li>
</ul>
<li>
<code>.</code>
</li>
<ul style="list-style-type:none;">
<li>
A period matches any single character. For example, <code>CC.</code> matches any P codon (<code>CCA</code>, <code>CCT</code>, <code>CCG</code>, <code>CCC</code>), but also strings like <code>CCX</code> and <code>CC%</code>.
</li>
</ul>
<li>
<code>[&lt;charset&gt;]</code>
</li>
<ul style="list-style-type:none;">
<li>
Matches any single character specified in <code>&lt;charset&gt;</code>. For example, <code>TA[CT]</code> matches a Y codon (<code>TAC</code> or <code>TAT</code>).
</li>
</ul>
<li>
<code>[^&lt;charset&gt;]</code>
</li>
<ul style="list-style-type:none;">
<li>
Placing a <code>^</code> as the first character inside charset brackets negates the meaning, such that any single character not named in the brackets is matched. <code>TA[^CT]</code> matches <code>TAA</code>, <code>TAG</code>, <code>TA%</code>, and so on, but not <code>TAC</code> or <code>TAT</code>.
</li>
</ul>
<li>
<code>^</code> (outside of <code>[]</code>)
</li>
<ul style="list-style-type:none;">
<li>
Placing a <code>^</code> outside of charset brackets matches the start of the input string or line. Using <code>sed -r 's/^ATG/XXX/g'</code>, for example, replaces all instances of start codons with <code>XXX</code>, but only if they exist at the start of the line.
</li>
</ul>
<li>
<code>$</code>
</li>
<ul style="list-style-type:none;">
<li>
Similar to <code>^</code>, but <code>$</code> matches the end of the string or line. So, <code>sed -r 's/ATG$/XXX/g'</code> replaces all start codons that exist at the end of their respective lines.
</li>
</ul>
</ul>
</ul>
<p>So far our patterns aren’t really all that flexible, because most of the pieces covered to this point match a single character. The next five meta-operators resolve that limitation.</p>
<ul style="list-style-type:none;">
<li>
<code>{x,y}</code>
</li>
<ul style="list-style-type:none;">
<li>
Modifies the preceding pattern so that it matches if it occurs between <code>x</code> and <code>y</code> times in a row, inclusive. For example, <code>[GC]{4,8}</code> matches any string of C’s and/or G’s that is four to eight characters long (shooting for eight characters, if possible). So, <code>sed -r 's/[GC]{4,8}/_X_/g'</code> would result in the following substitutions:<br>
<blockquote>
<code>ATCCGTCT</code> to <code>ATCCGTCT</code> (no replacement)<br>
<code>ATCCGCGGCTC</code> to <code>AT_X_TC</code><br>
<code>ATCGCGCGGCCCGTTCGGGCCT</code> to <code>AT_X_CCGTT_X_T</code>
</blockquote>
Using <code>{0,1}</code> has the effect of making what it follows optional in the pattern, and <code>{x,}</code> has the effect of allowing the pattern to match x or more times with no upper limit.
</li>
</ul>
<li>
<code>*</code>
</li>
<ul style="list-style-type:none;">
<li>
An asterisk modifies the preceding pattern so that it matches if it occurs zero or more times; thus it is equivalent to <code>{0,}</code>.<br><br>
The usage of <code>*</code> deserves a detailed example. Consider the pattern <code>ATG[ATGC]*TGA</code>, where <code>ATG</code> is the pattern for a start codon, <code>[ATGC]*</code> indicates zero or more DNA bases in a row, and <code>TGA</code> is one of the canonical stop codons. This pattern matches <code>ATGTACCTTGA</code>, and also matches <code>ATGTGA</code> (where the middle part has been matched zero times).
</li>
</ul>
<li>
<code>+</code>
</li>
<ul style="list-style-type:none;">
<li>
The most prominent repetition modifier, a plus sign modifies the preceding pattern so that it is matched one or more times; it is equivalent to <code>{1,}</code>. In contrast with the example above, <code>ATG[ATGC]+TGA</code> matches <code>ATGTACCTTGA</code> and <code>ATGCTGA</code>, but not <code>ATGTGA</code>.
</li>
</ul>
<li>
<code>(&lt;pattern&gt;)</code>
</li>
<ul style="list-style-type:none;">
<li>
Parentheses may be used to group an expression or series of expressions into a single unit so that they may be operated on together. Because <code>AT</code> is the pattern <code>A</code> followed by <code>T</code>, for example, <code>AT+</code> matches <code>AT</code>, <code>ATT</code>, <code>ATTT</code>, and so on. If we wanted to instead match <code>AT</code> repeats, we might wish to specify a pattern like <code>(AT)+</code>, which matches <code>AT</code>, <code>ATAT</code>, <code>ATATAT</code>, and so on. Parentheses also “save” the string that was matched within them for later use. This is known as back-referencing, discussed below.
</li>
</ul>
<li>
<code>&lt;pattern x&gt;|&lt;pattern y&gt;</code>
</li>
<ul style="list-style-type:none;">
<li>
Match either the pattern <code>&lt;pattern x&gt;</code> or the pattern<code>&lt;pattern y&gt;</code>. Multiple such patterns or operations can be chained; for example, <code>TAA|TAG|TGA</code> matches any one of the three canonical stop codons. This example is a bit ambiguous, though: does this pattern read “TA (A or T) A (G or T) GA,” or “TAA or TAG or TGA”? To make it concrete, we’d probably want to specify it as <code>((TAA)|(TAG)|(TGA))</code>.
</li>
</ul>
</ul>
</ul>
<p>Using these pieces, we can put together a regular expression that serves as a simple (and not actually useful in practice) open reading frame finder. For prokaryotic sequences (where introns are not a consideration), we’ll define these as a start codon <code>ATG</code>, followed by one or more codons, followed by one of the three canonical stop codons <code>TAA</code>, <code>TAG</code>, or <code>TGA</code>. The pattern for the start is <code>ATG</code>, and we’ve seen how we can encode a stop above, with <code>((TAA)|(TAG)|(TGA))</code>. How about “one or more codons?” Well, “one or more” is embodied in the <code>+</code> operator, and a codon is any three A’s, T’s, C’s, or G’s. So, “one or more codons” is encoded as (<code>[ACTG]{3,3})+</code>. Thus the regular expression for our simple open reading frame finder is:</p>
<div class="fig center" style="width: 100%">
<p><img src="images/part1-12-patterns.Rmd.images/I.12_5_regex_orf.png" /></p>
</div>
<div id="greedy" class="section level6 unnumbered">
<h6 class="unnumbered"></h6>
<p>In reality, regular expressions are not often used in searching for coding regions (though they are sometimes used for identifying smaller motifs). Part of the reason is that regular expressions are, by default, <em>greedy</em>: they match the first occurring pattern they can, and they seek to match as much of the string as they can. (The cellular machinery that processes open reading frames is not greedy in this way.) Consider the following sequence, which has three open reading frames according to our simple definition and regular expression above.</p>
<div class="fig center" style="width: 100%">
<p><img src="images/part1-12-patterns.Rmd.images/I.12_6_regex_orf_matches-2.png" /></p>
</div>
<p>Notice that the string <code>TAG</code> is both a type of codon in general (<code>[ACTG]{3,3}</code>) and a stop, so technically both of the first two options are valid according to the regular expression. By the rules of greediness, the first will be matched, which we can verify with a simple <code>echo</code> and <code>sed</code>.</p>
<pre id=part1-12-TAG
     class="language-txt 
            line-numbers 
            linkable-line-numbers">
<code>
[oneils@mbp ~/apcb/intro/fasta_stats]$ <b>echo "TATGCATGTTTAGTAGCTTTTAG" | \
> sed -r 's/ATG([ACTG]{3,3})+((TAA)|(TAG)|(TGA))/_ORF_/g'</b>
T_ORF_CTTTTAG
</code></pre>
<p>The regular expression syntax used by <code>sed</code> is similar to the syntax used in languages such as Perl, Python, and R. In fact, all of the examples we’ve seen so far would work the same in those languages (though they are applied by their own specific functions rather than a call to <code>sed</code>). One helpful feature provided by more modern regular expression engines like these is that operators like <code>*</code> and <code>+</code> can be made nongreedy (though I prefer the clearer term “reluctant”) by following them with a question mark. In Python, the regular expression <code>ATG([ACTG]{3,3})+?((TAA)|(TAG)|(TGA))</code> would match the second option. (When not following a <code>*</code>, or <code>+</code>, it makes the previous optional; thus <code>TG(T)?CC</code> is equivalent to <code>TG(T){0,1}CC</code>.) More sophisticated features allow the user to access all the matches of a pattern, even if they overlap, so that the most satisfying one can be pulled out by some secondary criteria. Unfortunately, <code>sed</code> does not support nongreedy matching and several other advanced regular expression features.</p>
</div>
</div>
<div id="character-classes-and-regular-expressions-in-other-tools" class="section level3 unnumbered hasAnchor">
<h3>Character Classes and Regular Expressions in Other Tools<a href="patterns-regular-expressions.html#character-classes-and-regular-expressions-in-other-tools" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We often wish to use charset brackets to match any one of a “class” of characters; for example, <code>[0123456789]</code> matches any single digit. Most regular expression syntaxes (including that used by <code>sed</code>) allow a shorthand version <code>[0-9]</code> (if we wanted to match only a 0, 9, or -, we could use <code>[09-]</code>). Similarly, <code>[a-z]</code> matches any single lowercase letter, and <code>[A-Z]</code> any uppercase letter. These can even be combined: <code>[A-Za-z0-9]</code> matches any digit or letter. In the POSIX extended syntax used by <code>sed</code>, <code>0-9</code> can also be specified as <code>[:digit:]</code>. Notice the lack of brackets in the former—to actually match any single digit, the regular expression is <code>[[:digit:]]</code> (which, yes, is annoying). To match any nondigit, we can negate the bracketed set as <code>[^[:digit:]]</code>.</p>
<p>These POSIX character classes are especially useful when we want to match character types that are difficult to type or enumerate. In particular, <code>[[:space:]]</code> matches one of any <a href="using-bioinformatics-software.html#whitespace">whitespace</a> character (spaces, tabs, newlines), and <code>[[:punct:]]</code> matches any “punctuation” character, of which there are quite a few. The <code>[[:space:]]</code> character class is particularly helpful when you are reformatting data stored in rows and columns but are not sure whether the column separators are spaces, tabs, or some combination.</p>
<p>In many regular expression syntaxes (including those used by Perl, Python, R, and some versions of <code>sed</code>), even shorter shortcuts for character classes are available. In these, <code>\d</code> is equivalent to <code>[[:digit:]]</code>, <code>\D</code> is equivalent to <code>[^[:digit:]]</code>, <code>\s</code> for <code>[[:space:]]</code>, <code>\S</code> for <code>[^[:space:]]</code>, among others.</p>
<p>As it turns out, regular expressions can be utilized by <code>grep</code> as well as <code>awk</code>. When using <code>grep</code>, we can specify that the pattern should be treated as an extended regular expression by adding the flag <code>-E</code> (as opposed to the <code>-r</code> used for <code>sed</code>.) Thus <code>grep -E '[[:digit:]]+'</code> extracts lines that contain an integer.</p>
<p>In <code>awk</code>, we can use the <code>~</code> comparator instead of the <code>==</code> comparator in an if-statement, as in <code>awk '{if($1 ~ /PZ718[[:digit:]]+/) {print $3}}'</code>, which prints the third column of each line where the first column matches the pattern <code>PZ718[[:digit:]]+</code>.</p>
</div>
<div id="back-referencing" class="section level3 unnumbered hasAnchor">
<h3>Back-Referencing<a href="patterns-regular-expressions.html#back-referencing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>According to the definition above for the header lines in the <a href="data/pz_cDNAs.fasta"><code>pz_cDNAs.fasta</code></a> file, the IDs should be characterizable as a pseudorandom identifier followed by, optionally, an underscore and a set of capital letters specifying the group. Using <code>grep '&gt;'</code> to extract just the header lines, we can inspect this visually:</p>
<pre id=part1-12-fasta
     class="language-txt 
            line-numbers 
            linkable-line-numbers">
<code><b>...
>PZ7180000037718 nReads=9 cov=6.26448
>PZ7180000000004_TY nReads=86 cov=36.4238
>PZ7180000000067_AF nReads=16 cov=12.0608
>PZ7180000031591 nReads=4 cov=3.26022
>PZ7180000024036 nReads=14 cov=5.86079
>PZ15501_A nReads=1 cov=1
...
</b></code></pre>
<p>If we send these results through <code>wc</code>, we see that this file contains 471 header lines. How can we verify that each of them follows this pattern? By using a regular expression with <code>grep</code> for the pattern, and comparing the count to 471. Because IDs must begin immediately after the <code>&gt;</code> symbol in a FASTA file, that will be part of our pattern. For the pseudorandom section, which may or may not start with <code>PZ</code> but should at least not include an underscore or a space, we can use the pattern <code>[^_[:space:]]+</code> to specify one or more nonunderscore, nonwhitespace characters. For the optional group identifier, the pattern would be <code>(_[A-Z]+){0,1}</code> (because <code>{0,1}</code> makes the preceding optional). Putting these together with <code>grep -E</code> and counting the matches should produce 471.</p>
<pre id=part1-12-header-count
     class="language-txt 
            line-numbers 
            linkable-line-numbers">
<code>
[oneils@mbp ~/apcb/intro/fasta_stats]$ <b>cat pz_cDNAs.fasta | \
> grep -E '>[^_[:space:]]+(_[A-Z]+){0,1}' | \
> wc</b>
    471    1413   15279
</code></pre>
<p>All of the headers matched the pattern we expected. What if they hadn’t? We could inspect which ones didn’t by using a <code>grep -v -E</code> to print the lines that didn’t match the pattern.</p>
<p>Now, hypothetically, suppose a (stubborn, and more senior) colleague has identified a list of important gene IDs, and has sent them along in a simple text file.</p>
<pre id=part1-12-gene-IDs
     class="language-txt 
            line-numbers 
            linkable-line-numbers">
<code><b>...
PZ7180000037718-gene
PZ7180000000004-gene_TY
PZ7180000000067-gene_AF
PZ7180000031591-gene
PZ7180000024036-gene
PZ15501-gene_A
...
</b></code></pre>
<p>Unfortunately, it looks like our colleague has decided to use a slightly altered naming scheme, appending <code>-gene</code> to the end of each pseudorandom identifier, before the <code>_</code>, if it is present. In order to continue with peaceful collaborations, it might behoove us to modify our sequence file so that it corresponds to this scheme. We can do this with <code>sed</code>, but it will be a challenge, primarily because we want to perform an insertion, rather than a substitution. Actually, we’ll be performing a substitution, but we’ll be substituting matches with contents from themselves!</p>
<p>Regarding back-references, in a regular expression, matches or submatches that are grouped and enclosed in parentheses have their matching strings saved in variables <code>\1</code>, <code>\2</code>, and so on. The contents of the first pair of parentheses is saved in <code>\1</code>, the second in <code>\2</code> (some experimentation may be needed to identify where nested parentheses matches are saved). The entire expression match is saved in <code>\0</code>.</p>
<p>To complete the example, we’ll modify the pattern used in the grep to capture both relevant parts of the pattern, replacing them with <code>\1-gene\2</code>.</p>
<div class="fig center" style="width: 100%">
<p><img src="images/part1-12-patterns.Rmd.images/I.12_10_sed_header_fix.png" /></p>
</div>
<p>The contents of <a href="data/pz_cDNAs.fasta"><code>pz_cDNAs.fasta</code></a>, after running it through the <code>sed</code> above, are as follows:</p>
<pre id=part1-12-update-fasta
     class="language-txt 
            line-numbers 
            linkable-line-numbers">
<code><b>...
>PZ456916-gene nReads=1 cov=1
AAACTGTCTCTAATTAATTTATAAAATTTAATTTTTTAGTAAAAAAGCTAAAATAATTTTAAAAGACGAG
AAGACCCTATAGAGTTTTATAATTTATTTAATTATTATTAATATATAAATTTTAAAATTAAAATTAGGTA
AATTATTTTGTTGGGGTGACAG
>PZ7180000037718-gene nReads=9 cov=6.26448
ACTTTTTTTTTAATTTATTTAATTATATTAACTAATAAATCCGTTGTAATTGTGAGTTTATATGCAATTT
CGAAGTAGAACCGTTTCACTGGAAAGCGTTGTGTTGTCAGTTCGGTCGCTCTTTCGTATTTTTAAATATA
AGTAGGCTTATAAATTGAAGCGTTTTGCTTCTTGACAATTTATCTTACTGCATATGTGATAAGTATCAGA
ATTGCCCGCAGTATTCCCGAAGCGAGCGACCGAAGCCGGTCAATGTGAAAAACGAAAAACATTTTTTTTA
TATAAGCAACAAAAAAAACCTCTTTATACGTTTAACTTAGATAGTTATTATTAATTTTAGCTTTTAATAG
GTGTTTCGATGATTTTCACGAATTTTTTTTTGTTTTCTCGCATTTAGCTAGCGATTGCAAGAGTCGCAGT
GTACATAATATAATAGTTAGACATGATATGGACAATACCTAACAAGTGAAAAGAAAAAAAATATCATTTT
ATTGAACAAATACATTCAGTGGAATTAT
>PZ7180000000004-gene_TY nReads=86 cov=36.4238
CCAAAGTCAACCATGGCGGCCGGGGTACTTTATACTTATCCGACAAACTTCCGTGCTTATAAGGCGTTGA
TCGCCGCACAGTACTCCGGGGTCGATCTTAAAGTTGCAACGGGTTTCGTATTTGGCGAGACAAATAAATC
TGAAGAGTTCCTGAAAAAATTCCCTGCGGGCAAAGTACCGGCTTATGAAAGTGCTGATGGAAAAGTGGTG
...
</b></code></pre>
<p>Back-references may be used within the pattern itself as well. For example, a <code>sed -r 's/([A-Za-z]+) \1/\1/g'</code> would replace “doubled” words <code>([A-Za-z]+) \1</code> with a single copy of the word <code>\1</code>, as in <code>I like sed very very much</code>, resulting in <code>I like sed very much</code>. But beware if you are thinking of using substitution of this kind as a grammar checker, because this syntax does not search across line boundaries (although more complex <code>sed</code> programs can). This example would not modify the following pair of lines (where the word <code>the</code> appears twice):</p>
<blockquote>
The quick sed regex modifies the<br>
the lazy awk output.
</blockquote>
<p>A few final notes about sed and regular expressions in general will help conclude this chapter.</p>
<ol>
<li>
Regular expressions, while powerful, lend themselves to mistakes. Work incrementally, and regularly check the results.
</li>
<li>
It is often easier to use multiple invocations of regular expressions (e.g., with multiple <code>sed</code> commands) rather than attempt to create a single complex expression.
</li>
<li>
Use regular expressions where appropriate, but know that they are not always appropriate. Many problems that might seem a natural fit for regular expressions are also naturally fit by other strategies, which should be taken into consideration given the complexity that regular expressions can add to a given command or piece of code.
</li>
</ol>
<blockquote>
<p>
Some people, when confronted with a problem, think, “I know, I’ll use regular expressions.” Now they have two problems.
</p>
<p style="text-align: right">
~Jamie Zawinski
</p>
</blockquote>
<div id="exercises-10" class="section level4 unnumbered hasAnchor exercises">
<h4>Exercises<a href="patterns-regular-expressions.html#exercises-10" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><p>In the de novo assembly statistics file <a href="data/contig_stats.txt"><code>contig_stats.txt</code></a>, the contig IDs are named as <code>NODE_1</code>, <code>NODE_2</code>, and so on. We’d prefer them to be named <code>contig1</code>, <code>contig2</code>, and the like. Produce <code>contig_stats_renamed.txt</code> with these changes performed.</p></li>
<li><p>How many sequences in the file <a href="data/pz_cDNAs.fasta"><code>pz_cDNAs.fasta</code></a> are composed of only one read? You will likely need to use both <code>awk</code> and <code>sed</code> here, and be sure to carefully check the results of your pipeline with <code>less</code>.</p></li>
<li><p>A particularly obnoxious colleague insists that in the file <a href="data/pz_cDNAs.fasta"><code>pz_cDNAs.fasta</code></a>, sequences that are not part of any group (i.e., those that have no <code>_</code> suffix) should have the suffix <code>_nogroup</code>. Appease this colleague by producing a file to this specification called <code>pz_cDNAs_fixed.fasta</code>.</p></li>
<li><p>The header lines in the yeast protein set <a href="data/orf_trans.fasta"><code>orf_trans.fasta</code></a> look like so when viewed with <code>less -S</code> after grepping for <code>&gt;</code>:<br></p>
<div class="fig center" style="width: 100%">
<img src="images/part1-12-patterns.Rmd.images/I.12_12_unix_139_2_orf_trans_headers.png" />
</div>
<p>Notably, header lines contain information on the locations of individual exons; sequence YAL001C has two exons on chromosome I from locations 151006 to 147594 and 151166 to 151097 (the numbers go from large to small because the locations are specified on the forward strand, but the gene is on the reverse complement strand). By contrast, sequence YAL002W has only one exon on the forward strand.<br><br>
How many sequences are composed of only a single exon? Next, produce a list of sequence IDs in a file called <code>multi_exon_ids.txt</code> containing all those sequence IDs with more than one exon as a single column.</p></li>
<li><p>As a continuation of question 4, which sequence has the most exons? Which single-exon sequence is the longest, in terms of the distance from the first position to the last position noted in the exon list?</p></li>
</ol>
</div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="29">
<li id="fn29"><p>POSIX, short for Portable Operating System Interface, defines a base set of standards for programs and operating systems so that different Unix-like operating systems may interoperate.<a href="patterns-regular-expressions.html#fnref29" class="footnote-back">↩︎</a></p></li>
<li id="fn30"><p>We should also note that the <code>/</code> delimiters are the most commonly used, but most characters can be used instead; for example, <code>s|&lt;pattern&gt;|&lt;replacement&gt;|g</code> may make it easier to replace <code>/</code> characters. Alternate delimiters are also often used when we end up with a command that looks like a “Picket Fence”, for example: <code>s\/usr/local/bin\/bin\g</code> becomes <code>s|/usr/local/bin|/bin|g</code><a href="patterns-regular-expressions.html#fnref30" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rows-and-columns.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="miscellanea.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/oneilsh/apcb_bookdown/edit/master/part1-12-patterns.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": {},
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
